# FIT跑步数据分析器 v1.5.0 发布说明

**发布日期**: 2025-12-22

## ✨ 功能增强

### FR025: IQ速度字段配速显示完整支持

**功能描述**:
- 扩展配速显示支持，覆盖所有ConnectIQ设备速度字段
- 确保IQ速度字段（如龙豆dr_speed）与标准速度字段显示一致
- 所有速度字段统一显示为配速单位（min/km），自动翻转Y轴

**新增支持字段**:
- `dr_speed` - 龙豆逐点速度 ✅ 已支持
- `dr_avg_speed` - 龙豆平均速度 🆕 新增
- `dr_max_speed` - 龙豆最大速度 🆕 新增
- `dr_lap_avg_speed` - 龙豆每圈平均速度 🆕 新增
- `dr_s_avg_speed` - 龙豆session平均速度 🆕 新增

**用户体验改进**:
1. **单位一致性**: 所有速度字段自动转换为配速（min/km）
2. **Y轴共享**: 叠加标准speed和IQ dr_speed时，共享同一个Y轴
3. **直观对比**: 不同数据源的速度字段可直接在同一坐标系对比
4. **自动翻转**: 配速Y轴自动翻转（值越小显示越高，符合跑步习惯）

**技术实现**:
- 扩展 `PACE_FIELDS` 数组，包含所有IQ速度字段变体
- 扩展 `FIELD_UNIT_TYPES` 映射，所有速度字段配置为 `'pace'` 类型
- 确保字段名匹配逻辑正确处理 `iq_` 前缀

**相关文件**:
- `frontend/js/charts.js` (L111-117, L120-129)

## ✅ 测试验证

### 自动化测试（MCP Playwright）
- ✅ **场景1**: 单独显示dr_speed - Y轴标签、配速格式、Y轴翻转验证通过
- ✅ **场景2**: 叠加speed + dr_speed - Y轴共享验证通过（只有1个Y轴）
- ✅ JavaScript验证: `count=1, hasYaxis2=false`

### 验证结果
- 所有IQ速度字段正确显示为配速单位
- 与标准速度字段完美共享Y轴
- 无回归问题

详见 [BUGS.md](BUGS.md) Issue #25 验证记录。

## 📦 安装与使用

### Windows用户
1. 下载 `fitanalysis-v1.5.0-windows.zip`
2. 解压到任意目录
3. 双击 `run.bat` 启动服务器
4. 浏览器访问 http://localhost:8080

### 开发者
```bash
git pull origin main
pip install -r backend/requirements.txt
python backend/main.py
```

## 🔄 从v1.4.1升级

无需特殊操作，直接替换可执行文件即可：
1. 备份现有数据目录（如有重要数据）
2. 解压新版本覆盖旧文件
3. 启动服务器，现有活动数据自动兼容

## 📊 版本对比

| 功能 | v1.4.1 | v1.5.0 |
|------|--------|--------|
| 标准速度字段配速显示 | ✅ | ✅ |
| dr_speed配速显示 | ✅ | ✅ |
| 其他IQ速度字段支持 | ❌ | ✅ 新增 |
| 速度字段Y轴共享 | ✅ | ✅ 增强 |
| 心率合并浮点精度 | ✅ | ✅ |

## 🎯 适用场景

特别适合使用以下设备的跑步爱好者：
- 龙豆跑步传感器（DragonRun Pod）
- 其他ConnectIQ设备和扩展字段
- 需要对比不同数据源速度表现的用户

## 📝 完整更新日志

- ✨ FR025: IQ速度字段配速显示扩展支持
- 🧪 自动化测试: MCP Playwright浏览器测试验证
- 📚 文档: agent.md添加US-008用户故事
- 🗑️ 清理: 移除临时测试脚本和缓存文件

详见 [agent.md](agent.md) FR025 和 US-008 部分。

---

**上一版本**: [v1.4.1](RELEASE_v1.4.1.md)  
**下一版本**: 开发中

## 🙏 致谢

感谢用户反馈和测试支持！
